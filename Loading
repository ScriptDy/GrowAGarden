local Players = game:GetService("Players")
local StarterGui = game:GetService("StarterGui")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "LoadingScreen"
screenGui.IgnoreGuiInset = true -- Cover the entire screen
screenGui.Parent = Players.LocalPlayer:WaitForChild("PlayerGui")

-- Create main frame (full black background)
local frame = Instance.new("Frame")
frame.Size = UDim2.new(1, 0, 1, 0)
frame.BackgroundColor3 = Color3.fromRGB(0, 0, 0) -- Solid black
frame.BackgroundTransparency = 0
frame.Parent = screenGui

-- Create "Pet Spawner" text (same style as percentage text)
local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(0.5, 0, 0.1, 0)
titleLabel.Position = UDim2.new(0.25, 0, 0.3, -20) -- Above percentage text
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "Pet Spawner"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.TextScaled = true
titleLabel.Font = Enum.Font.SourceSansBold
titleLabel.Parent = frame

-- Create percentage text (e.g., "Loading: 20%")
local percentLabel = Instance.new("TextLabel")
percentLabel.Size = UDim2.new(0.5, 0, 0.1, 0)
percentLabel.Position = UDim2.new(0.25, 0, 0.4, -20)
percentLabel.BackgroundTransparency = 1
percentLabel.Text = "Loading: 0%"
percentLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
percentLabel.TextScaled = true
percentLabel.Font = Enum.Font.SourceSansBold
percentLabel.Parent = frame

-- Create progress bar background
local progressBackground = Instance.new("Frame")
progressBackground.Size = UDim2.new(0.6, 0, 0.05, 0)
progressBackground.Position = UDim2.new(0.2, 0, 0.45, 0)
progressBackground.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
progressBackground.BorderSizePixel = 0
progressBackground.Parent = frame

-- Create progress bar fill
local progressFill = Instance.new("Frame")
progressFill.Size = UDim2.new(0, 0, 1, 0) -- Starts at 0 width
progressFill.Position = UDim2.new(0, 0, 0, 0)
progressFill.BackgroundColor3 = Color3.fromRGB(255, 165, 0) -- Orange
progressFill.BorderSizePixel = 0
progressFill.Parent = progressBackground

-- Create "GENERATING..." text
local generatingLabel = Instance.new("TextLabel")
generatingLabel.Size = UDim2.new(0.5, 0, 0.1, 0)
generatingLabel.Position = UDim2.new(0.25, 0, 0.5, 10)
generatingLabel.BackgroundTransparency = 1
generatingLabel.Text = "GENERATING..."
generatingLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
generatingLabel.TextScaled = true
generatingLabel.Font = Enum.Font.SourceSansBold
generatingLabel.Parent = frame

-- Disable Roblox core GUI (top bar and menu)
StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.All, false)

-- Block Esc key to prevent opening the Roblox menu
local function blockEscKey(input, gameProcessedEvent)
	if input.KeyCode == Enum.KeyCode.Escape and not gameProcessedEvent then
		return -- Prevent default Esc behavior
	end
end
UserInputService.InputBegan:Connect(blockEscKey)

-- Simulate loading progress over 2 minutes (120 seconds)
local totalTime = 120
local currentTime = 0
local function updateProgress()
	while currentTime < totalTime and frame.Parent do
		currentTime = currentTime + RunService.Heartbeat:Wait()
		local progress = math.min(currentTime / totalTime, 1)
		progressFill.Size = UDim2.new(progress, 0, 1, 0)
		percentLabel.Text = "Loading: " .. math.floor(progress * 100) .. "%"
		wait(0.1) -- Update every 0.1 seconds for smooth animation
	end
end

-- Fade out loading screen and restore core GUI
local function fadeOut()
	-- Re-enable core GUI before fading out
	StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.All, true)
	
	local tween = TweenService:Create(frame, TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.In), {BackgroundTransparency = 1})
	tween:Play()
	for _, child in pairs(frame:GetChildren()) do
		if child:IsA("GuiObject") then
			TweenService:Create(child, TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.In), {TextTransparency = 1}):Play()
		end
	end
	tween.Completed:Wait()
	screenGui:Destroy()
end

-- Start progress update
spawn(updateProgress)

-- Wait for 2 minutes and then fade out
wait(120)
fadeOut()
